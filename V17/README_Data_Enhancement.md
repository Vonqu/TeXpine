# 数据增强功能使用说明

## 概述

数据增强功能已经成功集成到QT软件中，提供了多种传感器数据增强算法，可以在滤波处理后进一步改善信号质量。

## 功能特性

### 1. 五种增强算法

1. **运动检测和锁定 (Motion and Lock)**
   - 增强动作过程中的幅度变化
   - 在保持阶段锁定数值防止下坠
   - 参数：差分窗口、运动阈值、运动增益、锁定平滑

2. **趋势增强 (Trend Enhancement)**
   - 基于信号变化趋势进行增强
   - 参数：Alpha参数、Gamma参数

3. **局部对比增强 (Local Contrast Enhancement)**
   - 对信号进行局部对比增强
   - 参数：窗口大小、增益系数

4. **梯度加速度增强 (Gradient Acceleration Enhancement)**
   - 同时使用斜率和加速度进行增强
   - 参数：Alpha参数、Beta参数

5. **分段归一化增强 (Segment-wise Normalized Enhancement)**
   - 检测高波动段并进行幅度增强
   - 参数：阈值、缩放系数

### 2. 二次滤波

每种增强算法后都可以选择应用二次滤波：
- **卡尔曼滤波**：过程噪声、测量噪声
- **Butterworth滤波**：截止频率、采样频率、滤波器阶数
- **Savitzky-Golay滤波**：窗口长度、多项式阶数

## 使用方法

### 1. 启动软件

运行主程序：
```bash
python main_window.py
```

### 2. 配置数据增强参数

1. 在控制面板中找到"数据增强设置"组
2. 勾选"启用数据增强"
3. 选择增强算法（默认：运动检测和锁定）
4. 调整算法参数
5. 选择是否启用二次滤波
6. 配置二次滤波参数

### 3. 数据处理流程

软件的数据处理流程为：
```
原始数据 → 滤波器 → 数据增强 → 二次滤波 → 显示/保存
```

### 4. 参数说明

#### 运动检测和锁定参数
- **差分窗口**：计算差分的滑动窗口大小（1-50）
- **运动阈值**：判断为"动作段"的斜率阈值（0.001-1.0）
- **运动增益**：对动作段增强的倍率（0.1-10.0）
- **锁定平滑**：对静止段使用的指数平滑因子（0.1-0.99）

#### 趋势增强参数
- **Alpha参数**：趋势增强强度（0.1-2.0）
- **Gamma参数**：趋势增强指数（1.0-5.0）

#### 局部对比增强参数
- **窗口大小**：局部窗口大小（3-51）
- **增益系数**：对比增强强度（0.1-5.0）

#### 梯度加速度增强参数
- **Alpha参数**：一阶导数权重（0.1-2.0）
- **Beta参数**：二阶导数权重（0.1-2.0）

#### 分段归一化增强参数
- **阈值**：高波动段判断阈值（0.001-1.0）
- **缩放系数**：增强缩放倍数（0.1-10.0）

## 测试验证

运行测试脚本验证功能：
```bash
python test_enhancement.py
```

测试脚本会：
1. 生成模拟传感器数据
2. 测试所有五种增强算法
3. 测试二次滤波功能
4. 生成对比图表保存为 `enhancement_test_results.png`

## 技术实现

### 核心模块

- **DataEnhancement类** (`data_enhancement.py`)：数据增强核心算法
- **控制面板扩展** (`control_panel.py`)：UI参数控制
- **主窗口集成** (`main_window.py`)：数据处理流程集成

### 关键方法

```python
# 数据增强处理
enhanced_data = data_enhancement.enhance_data(filtered_data)

# 参数设置
data_enhancement.set_enhancement_enabled(True)
data_enhancement.set_enhancement_method('motion_and_lock')
data_enhancement.set_motion_and_lock_params(diff_window=5, motion_thresh=0.015, ...)

# 获取参数
params = data_enhancement.get_enhancement_params()
```

## 注意事项

1. **性能考虑**：数据增强会增加计算负担，建议根据实际需求调整参数
2. **参数调优**：不同传感器和场景可能需要不同的参数设置
3. **实时性**：增强算法设计为实时处理，支持流式数据
4. **兼容性**：与现有的滤波功能完全兼容，可以独立启用/禁用

## 故障排除

### 常见问题

1. **增强效果不明显**
   - 检查参数设置是否合适
   - 尝试不同的增强算法
   - 调整二次滤波参数

2. **性能问题**
   - 减少历史数据窗口大小
   - 简化二次滤波参数
   - 考虑禁用某些增强功能

3. **参数设置问题**
   - 确保参数在有效范围内
   - 检查传感器数量设置
   - 验证数据格式

### 调试信息

软件会在控制台输出详细的处理信息：
- 增强参数变更
- 处理统计信息
- 错误和警告信息

## 更新日志

- **v1.0**：初始版本，集成五种增强算法和二次滤波
- 支持实时参数调整
- 完整的UI控制界面
- 测试验证脚本 